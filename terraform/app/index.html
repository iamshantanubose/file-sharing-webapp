<!DOCTYPE html>
<html>
<head>
    <title>File Sharing App</title>
    <script>
        let signalingServer;
        let devices = [];
        let peerConnection;

        const configuration = { iceServers: [{ urls: "stun:stun.l.google.com:19302" }] };

        function startDiscovery() {
            signalingServer = new WebSocket("ws://<EC2_PUBLIC_IP>:8080");

            signalingServer.onopen = () => {
                console.log("Connected to the signaling server");

                signalingServer.send(
                    JSON.stringify({ type: "register", id: generateUniqueID(), name: "Device A" })
                );
            };

            signalingServer.onmessage = (event) => {
                const message = JSON.parse(event.data);

                if (message.type === "deviceList") {
                    devices = message.devices;
                    updateDeviceList();
                }
            };
        }

        function updateDeviceList() {
            const deviceList = document.getElementById("deviceList");
            deviceList.innerHTML = "";
            devices.forEach((device) => {
                const li = document.createElement("li");
                li.innerText = `${device.name} (${device.address})`;
                li.onclick = () => initiateFileTransfer(device);
                deviceList.appendChild(li);
            });
        }

        function initiateFileTransfer(device) {
            alert(`Initiating file transfer to ${device.name}`);
        }

        function generateUniqueID() {
            return Math.random().toString(36).substr(2, 9);
        }
    </script>
</head>
<body>
    <h1>Welcome to the File Sharing App</h1>
    <button onclick="startDiscovery()">Discover Devices</button>
    <ul id="deviceList"></ul>
</body>
</html>
